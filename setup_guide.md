# วิธีการเชื่อมต่อกับ Google Sheets

เพื่อให้เว็บไซต์ดึงข้อมูลจาก Google Drive (Google Sheets) ได้จริง ให้ทำตามขั้นตอนดังนี้:

## 1. เตรียมข้อมูลใน Google Sheets
สร้าง Google Sheet ใหม่ และกำหนดหัวตาราง (Row 1) ดังนี้:
- Column A: `name` (ชื่อ)
- Column B: `surname` (นามสกุล)
- Column C: `class` (ชั้น)
- Column D: `certificate_url` (ลิงก์ไฟล์เกียรติบัตรจาก Google Drive)

> **สำคัญ:** ลิงก์เกียรติบัตรต้องเป็นลิงก์ที่เปิดดูได้ (Share to anyone with the link)

## 2. เผยแพร่ข้อมูล (Publish to Web)
1. ไปที่เมนู **File (ไฟล์)** > **Share (แชร์)** > **Publish to web (เผยแพร่ทางเว็บ)**
2. ในช่อง "Entire Document" (เอกสารทั้งหมด) ให้เลือกเฉพาะ Sheet ที่มีข้อมูล
3. ในช่อง "Web page" (เว็บเพจ) ให้เปลี่ยนเป็น **Comma-separated values (.csv)**
4. กดปุ่ม **Publish (เผยแพร่)**
5. คัดลอกลิงก์ที่ได้มา

## 3. นำลิงก์มาใส่ในโค้ด
1. เปิดไฟล์ `main.js`
2. แก้ไขบรรทัดที่เขียนว่า:
   ```javascript
   const DATA_SOURCE = './mock_data.json';
   ```
   ให้เป็น:
   ```javascript
   const DATA_SOURCE = 'วางลิงก์_CSV_ที่นี่';
   ```
   (อย่าลืมใส่เครื่องหมายคำพูด `'` ครอบลิงก์)

## 4. (ทางเลือก) ใช้สคริปต์ดึงข้อมูลอัตโนมัติ
หากคุณมีไฟล์จำนวนมากใน Google Drive และไม่อยากก๊อปปี้ลิงก์ทีละอัน เรามีสคริปต์ช่วย!

1. ไปที่ Google Sheet ของคุณ
2. กดเมนู **Extensions (ส่วนขยาย)** > **Apps Script**
3. ลบโค้ดที่มีอยู่ออกให้หมด
4. ก๊อปปี้โค้ดจากไฟล์ `generate_database_script.gs` ในโปรเจกต์นี้ไปวาง
5. กด Save (รูปแผ่นดิสก์) และกด Run (ปุ่ม Play)
6. อนุญาตสิทธิ์การเข้าถึง (Review Permissions)
7. กลับมาดูที่ Sheet ข้อมูลจะถูกดึงมาอัตโนมัติ!
   - **หมายเหตุ:** คุณอาจต้องมาเติมข้อมูล "ระดับชั้น" (Class) เอง หากในชื่อไฟล์ไม่ได้ระบุไว้

## 5. การแปลงข้อมูล CSV (ต้องปรับโค้ดเล็กน้อย)
เนื่องจากไฟล์ปัจจุบันรองรับ JSON แต่ Google Sheets ส่งมาเป็น CSV เราต้องเพิ่มฟังก์ชันแปลง CSV เป็น JSON ใน `main.js`

แจ้งให้เราทราบเมื่อคุณเตรียมข้อมูลเสร็จแล้ว เราจะอัปเดตโค้ดให้รองรับ CSV ทันที!
